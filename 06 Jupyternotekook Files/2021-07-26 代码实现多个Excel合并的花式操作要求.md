```python
# 一、合并指定目录下的所有订单表

import pandas as pd
from pathlib import Path

files = Path("orders/orders1").glob("*.xlsx")
dfs = [pd.read_excel(f) for f in files]
df = pd.concat(dfs)
df.to_excel("result2.xlsx",index = False)
```


```python
# 二、合并指定目录下的指定订单表

dfs = [pd.read_excel(f) for f in ('orders/orders1/order1.xlsx','orders/orders1/order2.xlsx')]
df = pd.concat(dfs)
df.to_excel("result3.xlsx",index = False)
```


```python
# 三、合并指定目录指定订单表的指定字段

table1 = pd.read_excel("orders/orders1/order1.xlsx")
table2 = pd.read_excel('orders/orders1/order2.xlsx')
part1 = table1.iloc[:,2]  #取order1.xlsx第3列的所有行
part2 = table2.iloc[:,[8,9]]  #取order2.xlsx的第9、10列的所有行
result4 = pd.concat([part1,part2],axis = 1 ) #合并  

# 以上注意axis=1表示横向合并。打印一下result4，长这样
```


```python
# 四、合并所有目录下的所有订单表

import pandas as pd
import os
file_list = os.walk("./")
result = []

for dir_path,dirs,files in file_list:
    for f in files:
        file_path = os.path.join(dir_path,f) #重构文件路径
        print(file_path)
        if 'xlsx' in f:    #只要xlsx文件
            df = pd.read_excel(file_path) #将Excel转成DataFrame
            result.append(df)
print(result)

df = pd.concat(result) #多个DataFrame合成一个
df.to_excel("result4.xlsx",index=False) #导入到一个新的Excel中
```


```python
import os

def find_image_filepaths(dataset_dir):
    result = []
    for root, dirs, files in os.walk(dataset_dir):
        for name in files:
            fp = os.path.join(root, name)
            if name.endswith(".jpg"):
                result.append(fp)
    return result 

find_image_filepaths(r"C:\Users\win\Desktop\1 - 副本")
```


```python
# 批量读取 excel

import pandas as pd 
import os 
path=r"C:\Users\win\Desktop\1 - 副本"
filename_list = os.listdir(r"C:\Users\win\Desktop\1 - 副本")
train_data=[]
for item in filename_list:
    train_data.append(pd.read_excel(path+'/'+item))
train_data=pd.concat(train_data)
train_data
```

```python
# 将 PDF 文档 分割成图片
import sys
import fitz
import os
import datetime


def pyMuPDF_fitz(pdfPath, imagePath):
    startTime_pdf2img = datetime.datetime.now()  # 开始时间

    print("imagePath="+imagePath)
    pdfDoc = fitz.open(pdfPath)
    for pg in range(pdfDoc.pageCount):
        page = pdfDoc[pg]
        rotate = int(0)
        # 每个尺寸的缩放系数为1.3，这将为我们生成分辨率提高2.6的图像。
        # 此处若是不做设置，默认图片大小为：792X612, dpi=72
        zoom_x = 1.33333333  # (1.33333333-->1056x816)   (2-->1584x1224)
        zoom_y = 1.33333333
        mat = fitz.Matrix(zoom_x, zoom_y).preRotate(rotate)
        pix = page.getPixmap(matrix=mat, alpha=False)

        if not os.path.exists(imagePath):  # 判断存放图片的文件夹是否存在
            os.makedirs(imagePath)  # 若图片文件夹不存在就创建

        pix.writePNG(imagePath+'/'+'images_%s.png' % pg)  # 将图片写入指定的文件夹内

    endTime_pdf2img = datetime.datetime.now()  # 结束时间
    print('pdf2img时间=', (endTime_pdf2img - startTime_pdf2img).seconds)


if __name__ == "__main__":
    pdfPath = r"D:\教学工具软件\冰点文库下载器 3.2.10 去广告版\冰点文库下载器 3.2.10 去广告版\kpdf\哪些人适合学Python培训，你在其中吗？.pdf"
    imagePath = r"D:\1jieya\image"
    pyMuPDF_fitz(pdfPath, imagePath)

```


```python
# 将图片去除水印，配合上一个程序使用
from itertools import product
from PIL import Image

# img = Image.open(r"D:\1jieya\image\images_0.png")
# width, height = img.size
# for pos in product(range(width), range(height)):
#     if sum(img.getpixel(pos)[:3]) > 600:
#         img.putpixel(pos, (255, 255, 255))
# img.save(r"C:\Users\win\Desktop\removed_1.png")


import os
import sys
import pandas as pd
import numpy as np
from datetime import datetime

input = r"D:\1jieya\image"
output = r"D:\1jieya\remove"


def modify():
    for image_name in os.listdir(input):
        print(image_name)
        img = Image.open(os.path.join(input, image_name))
        width, height = img.size
        for pos in product(range(width), range(height)):
            if sum(img.getpixel(pos)[:3]) > 600:
                img.putpixel(pos, (255, 255, 255))
        img.save(os.path.join(output, image_name))


if __name__ == '__main__':
    modify()
```


```python
# 批量将图片修改为指定大小

import os
from PIL import Image, ImageFilter, ImageDraw

# im = Image.open(r"C:\Users\win\Desktop\ccc\20200706130733539.png")

# 获取图片的格式，大小，以及模式
# print(im.format, im.size, im.mode)

# 指定图片的像素
# im.thumbnail((720, 1280))
# im.save(r"C:\Users\win\Desktop\ccc\128_128.jpg")

# 旋转图片的方向
# dest_im = im.rotate(90)
# dest_im.save(r"C:\Users\win\Desktop\ccc\90.png")

# 给图片添加滤镜
# dest_im = im.filter(ImageFilter.GaussianBlur)
# dest_im.show()

# # 图片反转
# dest_im = im.transpose(Image.FLIP_LEFT_RIGHT)
# dest_im = im.transpose(Image.FLIP_TOP_BOTTOM)
# dest_im.show()

# 图片上写文字
# image = Image.open(r"C:\Users\win\Desktop\ccc\20200706130733539.png")
# img_draw = ImageDraw.Draw(image)
# img_draw.text((1270, 1250), 'hello world!', fill='green')
# image.show()

# 批量将图片的大小设置为指定大小

in_path = r"C:\Users\win\Desktop\ccc"
out_path = os.path.join(in_path, 'modify')
if not os.path.exists(out_path):
    os.makedirs(out_path)


def modify():
    for image_name in os.listdir(in_path):
        cur_dir = in_path + '/' + image_name
        if os.path.isfile(cur_dir):
            print(f'正在处理:{cur_dir}')
            im = Image.open(cur_dir)
            im.thumbnail((1280, 720))
            im.save(os.path.join(out_path, image_name))


if __name__ == '__main__':
    modify()

```
